#!/Perl/bin

use LWP::Simple;
use CGI;

#asks for info for grabber
print "Checks:";
$limit = <STDIN>;
chomp ($limit);
print "starting number: ";
$start = <STDIN>;
chomp ($start);

#sets veriables to 0
$x = 0;
$win = 0;
$fail = 0;
print "\n\n";

#starts connection to network and a tor proxy server
#$connect = LWP::UserAgent->new;
#$connect->agent("");
#$connect->proxy(['socks'], 'http://127.0.0.1:9150/');

#starts loop
while ($x < $limit){
	$number = $start + $x;
	$url = "https://todaysmeet.com/api/room/" . $number;
	$contents = get($url);
	if ($contents ne ""){
		#prints results to file BEGGINING
		$fh = open(F, ">>getinfo.txt") || die "Error: unable to open $file - $!\n";
		print F "<a class='text'>" . $number . "</a>- <a class='text' href='https://todaysmeet.com/room/" . $number . "'>website</a> | <a class='text' href='index.php?value=" . $number . "'>display</a>\n\n";
		close(F);
		#prints results to file ENDING
		#pushes notifications
		print "Successfully Grabbed: " . $number . "!\n";
		$win = $win + 1;
	}else{
		#pushes notifications
		print "File: " . $number . " is empty cannot grab!\n";
		$fail = $fail + 1;
	}
	$x = $x + 1;
}
#prints total stats for search
print "\nSearches - \n";
print  "Total: " . $limit . "\nSuccessful: " . $win . "\nFailed: " . $fail;
print "\n\n";

#ends connection
